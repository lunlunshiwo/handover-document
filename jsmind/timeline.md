# jsmind条件选择模块

## 项目内容  

* 本次项目的内网地址为[http://10.60.7.6/OMReport/main?xwl=ide](http://10.60.7.6/OMReport/main?xwl=ide)，应用地点为山大-康评健康医疗大数据科研整合平台，项目组组长王永超，协助人王晓鹤，登录账号为账号：lll，密码：123456（或者111111）。
* 本次项目基于[vue](https://cn.vuejs.org/)框架，vue框架承担了交互和数据渲染功能的实现。
* 本次项目主体内容是时间轴，源代码在本文件夹的 **源代码文件夹中**,这份源码里面有两个文件，第一个 **index.html**是存放html的，第二个文件 **add.js**是存放新建按钮对应的事件（其余两个事件和这个类似）的，在后续工作中改错了，无法还原时使用的，建议不要自行修改，后果自负。

## 项目思路

* 本次项目主体为一个基于jsmind思维导图（[文档地址](http://hizzgdev.github.io/jsmind/developer.html)）的条件选择模块，该插件中文文档编写精致准确，不多做解释。

* 以新建为例，一开始创建一个jsmind实例，所有的操作都是基于这个实例进行操作的，这个实例的渲染方法是基于 **源代码中的jsmind.js**的,大概意思是把自定义dom节点按照一定的规律渲染成canvas。因此，新建事件直接渲染一个内容为空的思维导图，双击修改或者查看事件都会传入一个对象内容，这块曾经为王晓鹤负责。

* 在一般网页上右单击事件会导致相应的结果出现，比如出现浏览器自定义的一下功能弹窗之类的，为了防止这种事件的产生，我在思维导图部分添加了一个阻止事件冒泡的方法`@contextmenu.stop`,具体写法参考[vue事件修饰符](https://cn.vuejs.org/v2/guide/events.html#%E4%BA%8B%E4%BB%B6%E4%BF%AE%E9%A5%B0%E7%AC%A6)。在思维导图中，左键可以选中jsmind节点，但是只有右键才会弹出弹窗进行操作。当单机鼠标右键时，会获得选中的 **dom**，此时会判断是不是可以操作的dom节点————jsmind的节点。如果不是则会触发清零操作，即所有的弹窗会关闭，正在输入的数据清零。

* 当弹窗弹出之前，节点会根据获取到的jsmind节点中带的信息判断这个节点的 **父节点**是不是 **root**，如果是则只会弹出添加弹窗。如果不是则会判断是不是 **中间**的节点，如果是则会弹出添加、修改、删除 **三个**弹窗。如果是 **最后一个**则会弹出 **四个**弹窗，如果点击的节点正好是 **赋值**的节点，则 **只**会弹出 **删除**按钮。

* 由于我在文件中已经将 **jsmind**对象命名为 **_jm**，代码：`_jm= jsMind.show(options, mind)`。因此调用这个对象的方法需要使用`_jm.XXXXX`,如每次操作jsmind节点是需要接触保护`_jm.enable_edit()`和增加保护`_jm.disable_edit()`。

* 赋值功能为后来想到添加的，并且给jsmind节点添加了一个是否赋值的属性。给赋值项添加一个不同的颜色的方法为`_jm.set_node_color(nodeid, 'rgb(66, 139, 202)', '#fff')`。
